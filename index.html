<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>KAERI CBU First-Year Revision Resources 2025</title>
    
    <meta name="description" content="KAERI CBU provides essential first-year revision resources and exam prep for CBU students. Access past papers and quizzes for BI110, CS110, MA110, PH110, and LA111 in 2025.">
    <meta name="keywords" content="CBU first-year revision, CBU first-year past papers, CBU exam prep, CBU study resources, BI110 past papers, CS110 quizzes, First-year exam questions">
    
    <meta property="og:title" content="KAERI CBU first-year Revision Resources 2025">
    <meta property="og:description" content="Official KAERI CBU site for first-year students to find revision materials.">
    <meta property="og:type" content="website">
    
    <link rel="stylesheet" href="assets/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* === LANDING PAGE STYLES === */
        body {
            padding-top: 50px; /* Default for landing */
            text-align: center;
            background: #0d1b2a;
            color: #e0e6ed;
        }
        .quiz-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 30px;
            background: #1b263b;
            border-radius: 16px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        h1 {
            color: #72efdd;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        .course-section {
            margin-bottom: 40px;
            border: 1px solid #007bff;
            border-radius: 10px;
            padding: 20px;
        }
        .course-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1.2em;
            cursor: pointer;
            border-radius: 8px;
            margin-bottom: 20px;
            width: 100%;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
        }
        .course-button:hover {
            background-color: #0056b3;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.4);
        }
        .course-button.active {
            background-color: #28a745;
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
        }
        .course-button.coming-soon {
            background-color: #6c757d;
            cursor: default;
            box-shadow: none;
        }
        .term-buttons {
            display: none;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        .term-buttons button {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 1em;
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.3s ease, transform 0.2s ease;
            width: 100%; /* Ensure full width in SPA mode */
        }
        .term-buttons button:hover {
            background-color: #5a6268;
            transform: translateY(-2px);
        }

        /* === APP VIEW STYLES (Previously inline in Term pages) === */
        .back-button {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            border-radius: 8px;
            margin-top: 20px;
            text-decoration: none;
            display: inline-block;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .back-button:hover {
            background-color: #5a6268;
            transform: translateY(-2px);
        }
        
        /* Fix for fixed header in App Mode */
        body.app-mode {
            padding-top: 0; /* Reset */
        }
        #fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: #1b263b;
            z-index: 1001;
            padding: 10px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            box-sizing: border-box;
        }
        
        /* Floating Price Banner */
        #price-banner {
            position: fixed;
            top: 60px;
            right: 20px;
            background: #007bff;
            color: white;
            padding: 10px 16px;
            font-weight: 700;
            font-size: 1rem;
            border-radius: 8px;
            z-index: 1000;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        }

        /* Notification Styles */
        #app-notification {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 90%;
            text-align: center;
            font-size: 0.95em;
        }
        #app-notification.show { opacity: 1; visibility: visible; }
        #app-notification.info { background-color: #17a2b8; }
        #app-notification.success { background-color: #28a745; }
        #app-notification.warning { background-color: #ffc107; color: #333; }
        #app-notification.error { background-color: #dc3545; }
        #app-notification .close-btn { background: none; border: none; color: white; font-size: 1.2em; cursor: pointer; margin-left: 10px; }

        /* WhatsApp Button */
        .landing-whatsapp-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #25D366;
            color: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.2em;
            text-decoration: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        .landing-whatsapp-button:hover { transform: translateY(-5px) scale(1.05); }

        .seo-hidden { position: absolute; width: 1px; height: 1px; overflow: hidden; clip: rect(0,0,0,0); }
    </style>
</head>
<body>

    <!-- GLOBAL NOTIFICATION SYSTEM -->
    <div id="app-notification" role="alert">
        <span class="notification-message"></span>
        <button class="close-btn" aria-label="Close notification">√ó</button>
    </div>

    <!-- ================= VIEW 1: LANDING PAGE ================= -->
    <div id="view-landing">
        <div class="quiz-container">
            <h1>Select a Course & Term</h1>
            <h2 class="seo-hidden">CBU First-Year Course Revision Resources: BI110, CS110, MA110, PH110, LA111 Past Papers and Exam Prep</h2>

            <!-- BI110 Section -->
            <div class="course-section">
                <button class="course-button" onclick="toggleLandingTerms('bi110')">BI110 - Biology</button>
                <div id="bi110-terms" class="term-buttons">
                    <button onclick="loadApp('BI110', 'T1')">Term 1</button>
                    <button onclick="loadApp('BI110', 'T2')">Term 2</button>
                    <button onclick="loadApp('BI110', 'T3')">Term 3</button>
                </div>
            </div>

            <!-- CS110 Section -->
            <div class="course-section">
                <button class="course-button" onclick="toggleLandingTerms('cs110')">CS110 - Computer Science</button>
                <div id="cs110-terms" class="term-buttons">
                    <button onclick="loadApp('CS110', 'T1')">Term 1</button>
                    <button onclick="loadApp('CS110', 'T2')">Term 2</button>
                    <button onclick="loadApp('CS110', 'T3')">Term 3</button>
                </div>
            </div>
            
            <!-- Coming Soon Sections -->
            <div class="course-section"><button class="course-button coming-soon" disabled>CH110 - Chemistry (Coming Soon)</button></div>
            <div class="course-section"><button class="course-button coming-soon" disabled>MA110 - Mathematics (Coming Soon)</button></div>
            <div class="course-section"><button class="course-button coming-soon" disabled>PH110 - Physics (Coming Soon)</button></div>
            <div class="course-section"><button class="course-button coming-soon" disabled>LA111 - Communication skills (Coming Soon)</button></div>
        </div>
    </div>

    <!-- ================= VIEW 2: THE QUIZ APP (Hidden Initially) ================= -->
    <div id="view-app" style="display: none;">
        
        <!-- Fixed Header from Term Page -->
        <div id="fixed-header">
            <div id="mode-banner"></div>
            <div id="progress-container">
                <div id="progress-fill"></div>
            </div>
            <div id="progress-text">Progress: 0 of 0</div>
        </div>

        <div id="price-banner">Price: K15</div>

        <div class="quiz-container" style="margin-top: 80px;"> <!-- Added margin for fixed header -->
            <h1 id="app-title">Course Term Title</h1>
            
            <p class="announcement">
                <strong>Important:</strong> This platform is powered by your support! If you find it useful, please consider purchasing an access code.
            </p>
            
            <p class="price-list" id="app-price-info">
                <!-- Price Info Injected Here -->
            </p>

            <div class="mode-buttons">
                <button onclick="renderQuiz()">üìã Multiple Choice</button>
                <button onclick="renderShortAnswers()">‚úçÔ∏è Short Answer</button>
                <button onclick="renderEssaySimulation()">üìù Essay Simulation</button>
                <button onclick="renderFlashcardTopics()">üÉè Flashcards</button>
            </div>

            <div id="quiz-form"></div>
            <div id="result"></div>

            <button class="back-button" onclick="goHome()">‚¨ÖÔ∏è Back to Course Selection</button>
        </div>

        <div class="whatsapp-buttons" style="text-align: center; margin-top: 20px;">
            <a href="https://chat.whatsapp.com/FnYwrwYzxP1DScBwqL6dBV" target="_blank">
                <button style="background-color: #25D366; border:none; padding:10px 20px; color:white; border-radius:8px; cursor:pointer;">Join for the updates üì¢</button>
            </a>
        </div>
    </div>

    <!-- Shared WhatsApp Floating Button -->
    <a href="https://wa.me/260964312504" target="_blank" class="landing-whatsapp-button">üí¨</a>

    <!-- === DATA LOADING === -->
    <!-- Assumes these files exist in your assets folder -->
    <script src="assets/mcqDa.js"></script>
    <script src="assets/shortDa.js"></script>
    <script src="assets/essayDa.js"></script>
    <script src="assets/flashcards.js"></script>
    
    <!-- === LOGIC SCRIPT (Must be the Updated Version provided previously) === -->
    <script src="assets/script.js"></script>

    <!-- === SPA ROUTER LOGIC === -->
    <script>
        // CONFIGURATION: Define Titles and Prices for each Term
        const COURSE_CONFIG = {
            "CS110_T1": { price: "K15", title: "CS110 Term 1 Study Materials" },
            "CS110_T2": { price: "K15", title: "CS110 Term 2 Study Materials" },
            "CS110_T3": { price: "K20", title: "CS110 Term 3 Study Materials" },
            "BI110_T1": { price: "K15", title: "BI110 Term 1 Study Materials" },
            "BI110_T2": { price: "K15", title: "BI110 Term 2 Study Materials" },
            "BI110_T3": { price: "K20", title: "BI110 Term 3 Study Materials" }
        };

        // Toggle Landing Page Accordions
        function toggleLandingTerms(courseId) {
            const termButtons = document.getElementById(courseId + '-terms');
            const courseButton = termButtons.previousElementSibling;

            if (termButtons.style.display === 'flex') {
                termButtons.style.display = 'none';
                courseButton.classList.remove('active');
            } else {
                document.querySelectorAll('.term-buttons').forEach(section => {
                    if (section.id !== courseId + '-terms') {
                        section.style.display = 'none';
                        section.previousElementSibling.classList.remove('active');
                    }
                });
                termButtons.style.display = 'flex';
                courseButton.classList.add('active');
            }
        }

        // START THE APP (SPA TRANSITION)
        function loadApp(course, term) {
            const key = `${course}_${term}`;
            const config = COURSE_CONFIG[key] || { price: "K15", title: `${course} ${term}` };

            // 1. Switch CSS Mode
            document.body.classList.add('app-mode');
            document.body.style.paddingTop = "0px"; 

            // 2. Switch Views
            document.getElementById('view-landing').style.display = 'none';
            document.getElementById('view-app').style.display = 'block';
            window.scrollTo(0, 0);

            // 3. Update DOM Content
            document.getElementById('app-title').textContent = config.title;
            document.getElementById('price-banner').textContent = `Price: ${config.price}`;
            
            document.getElementById('app-price-info').innerHTML = `
                üí∞ ${course} ${term}: <strong>${config.price}</strong><br>
                To MTN 0961005406 or Airtel 0974784161<br>
                Or to Zanaco Account: 4584568100159 (Kaluluma Kaumbu)<br>
                üìû WhatsApp proof to <a href="https://wa.me/260964312504" target="_blank">0964312504</a><br>
                ‚úÖ Your support keeps the app free & online.
            `;

            // 4. Initialize Logic (Calls function in script.js)
            if (typeof initializeQuizApp === 'function') {
                initializeQuizApp(course, term);
            } else {
                console.error("initializeQuizApp missing. Did you update assets/script.js?");
            }

            // 5. Update URL history
            history.pushState({view: 'app', course, term}, "", `?c=${course}&t=${term}`);
        }

        // GO BACK HOME
        function goHome() {
            document.body.classList.remove('app-mode');
            document.body.style.paddingTop = "50px";

            document.getElementById('view-app').style.display = 'none';
            document.getElementById('view-landing').style.display = 'block';
            
            // Clean up
            document.getElementById("quiz-form").innerHTML = "";
            document.getElementById("result").innerHTML = "";
            
            history.pushState({view: 'home'}, "", window.location.pathname);
        }

        // Handle Browser Back Button
        window.onpopstate = function(event) {
            if (event.state && event.state.view === 'app') {
                loadApp(event.state.course, event.state.term);
            } else {
                goHome();
            }
        };

        // Handle Direct URL Links (Bookmarks)
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const c = urlParams.get('c');
            const t = urlParams.get('t');
            if (c && t) {
                loadApp(c, t);
            }
        });
    </script>
</body>
</html>